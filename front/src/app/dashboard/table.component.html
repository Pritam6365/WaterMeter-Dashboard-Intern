<div class="container-fluid">
  <div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h4 class="mb-0">Industry Meter Data</h4>
      <div>
        <span class="badge bg-info me-2" *ngIf="totalRecords > 0">
          Showing {{ rowData.length }} of {{ totalRecords }}
        </span>
        <button class="btn btn-outline-primary btn-sm" (click)="refresh()" [disabled]="loading">
          <i class="bi bi-arrow-clockwise"></i>
          Refresh
        </button>
      </div>
    </div>
    
    <div class="card-body">
      <!-- Initial Loading State -->
      <div *ngIf="initialLoading" class="text-center p-4">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-2">Loading initial data...</p>
      </div>

      <!-- Error State -->
      <div *ngIf="error && !initialLoading" class="alert alert-danger">
        <h6>Error Loading Data</h6>
        <p>{{ error }}</p>
        <button class="btn btn-danger btn-sm" (click)="refresh()">
          Try Again
        </button>
      </div>

      <!-- Data Table -->
      <div *ngIf="!initialLoading && !error && rowData.length > 0" class="table-responsive">
        <table class="table table-striped table-hover">
          <thead class="table-dark sticky-top">
            <tr>
              <th>Industry Name</th>
              <th>Division</th>
              <th>Month</th>
              <th>Initial Reading</th>
              <th>Final Reading</th>
              <th>Difference</th>
              <th>Financial Year</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let row of rowData; let i = index">
              <td class="text-truncate" style="max-width: 200px;" [title]="row.industryname">
                {{ row.industryname }}
              </td>
              <td>{{ row.division_id }}</td>
              <td>{{ row.month_id }}</td>
              <td class="text-end">{{ row.initialmeter_reading | number:'1.2-2' }}</td>
              <td class="text-end">{{ row.finalmeter_reading | number:'1.2-2' }}</td>
              <td class="text-end" 
                  [class.text-success]="row.meterreadingdifference > 0" 
                  [class.text-danger]="row.meterreadingdifference < 0">
                {{ row.meterreadingdifference | number:'1.2-2' }}
              </td>
              <td>{{ row.financial_year || 'N/A' }}</td>
            </tr>
          </tbody>
        </table>
        
        <!-- Loading more data indicator -->
        <div *ngIf="loading && !initialLoading" class="text-center p-3">
          <div class="spinner-border spinner-border-sm text-primary" role="status">
            <span class="visually-hidden">Loading more...</span>
          </div>
          <span class="ms-2 text-muted">Loading more records...</span>
        </div>
        
        <!-- All data loaded indicator -->
        <div *ngIf="allDataLoaded && rowData.length > 0" class="text-center p-3">
          <span class="text-muted">
            <i class="bi bi-check-circle"></i>
            All {{ rowData.length }} records loaded
          </span>
        </div>
      </div>

      <!-- No Data State -->
      <div *ngIf="!initialLoading && !error && rowData.length === 0" class="text-center p-4">
        <i class="bi bi-inbox display-1 text-muted"></i>
        <h5 class="mt-3">No Data Found</h5>
        <p class="text-muted">There are no meter readings available.</p>
      </div>
    </div>
  </div>
</div>
